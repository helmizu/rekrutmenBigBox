<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Recruitment Bigbox</title>
    <link rel="stylesheet" href="./assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="./assets/css/styles.css">
</head>
<body onload="dataLoad()">
    <nav class="navbar navbar-dark bg-dark">
        <a class="navbar-brand" href="#">
            <img src="./assets/images/bigboxlogowhite.png" width="30" height="30" class="d-inline-block align-top" alt=""> Bigbox
        </a>
    </nav>
    <div class="container-fluid pb-3">
        <!-- Daily Performance -->
        <div class="row py-3">
            <div class="col-lg-5">
                <div class="card mb-3">
                    <div class="card-body">
                        <div class="media">
                            <img src="./assets/images/profile.png" class="mr-3" width="auto" height="55px" alt="profile">
                            <div class="media-body">
                                <h5 class="mt-0">Helmi Zulfikar</h5>
                                <span>helmi.zulfikar20@gmail.com</span>
                            </div>
                        </div>
                        <div class="btn-notif mt-2">
                            <button type="button" class="btn btn-danger btn-block" onclick="openSidePage()">
                                <span class="badge badge-light ct_notif">10</span> Notifications
                            </button>
                            <button type="button" class="btn btn-success btn-block" onclick="openSidePage()">
                                <span class="badge badge-light ct_inbox">12</span> Inbox
                            </button>
                            
                            <button type="button" class="btn btn-light btn-block mt-3" data-toggle="modal" data-target="#modalExit">
                                <span class="text-danger">Exit</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header card-header-costum">
                        <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                            <div class="btn-group" role="group" aria-label="First group">
                                <button type="button" class="btn btn-danger">Column</button>
                                <button type="button" class="btn btn-secondary">Pie</button>
                            </div>
                            <h5 class="card-title card-title-costum text-danger">
                                Daily Performance
                            </h5>
                        </div>
                    </div>
                    <div class="card-body">                        
                        <div id="dailyChartColumn" style="height: 400px; margin: 0 auto"></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-7">
                <div class="card">
                    <div class="card-header card-header-costum">
                        <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                            <div class="btn-group" role="group" aria-label="First group">
                            </div>
                            <h5 class="card-title card-title-costum text-danger">
                                Daily Performance
                            </h5>
                        </div>
                    </div>
                    <div class="card-body">
                        <table id="dailyPerformance" class="table table-striped table-bordered" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Day</th>
                                    <th>Target Time (H)</th>
                                    <th>Work Time (H)</th>
                                    <th>Achievement (%)</th>
                                    <th>Overtime (H)</th>
                                    <th></th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Year Summary Performance -->
        <div class="card">
            <div class="card-header card-header-costum text-right">
                <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                    <div class="input-group">
                        <div class="form-group mr-3">
                            <label for="exampleFormControlSelect1" class="text-muted"><small>Start Date</small></label>
                            <select id="sd" class="form-control" id="exampleFormControlSelect1">
                                <option value="0" selected>All</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                                <option value="13">13</option>
                                <option value="14">14</option>
                                <option value="15">15</option>
                                <option value="16">16</option>
                                <option value="17">17</option>
                                <option value="18">18</option>
                                <option value="19">19</option>
                                <option value="20">20</option>
                                <option value="21">21</option>
                                <option value="22">22</option>
                                <option value="23">23</option>
                                <option value="24">24</option>
                                <option value="25">25</option>
                                <option value="26">26</option>
                                <option value="27">27</option>
                                <option value="28">28</option>
                                <option value="29">29</option>
                                <option value="30">30</option>
                                <option value="31">31</option>
                            </select>
                        </div>
                        
                        <div class="form-group mr-3">
                            <label for="exampleFormControlSelect1" class="text-muted"><small>End Date</small></label>
                            <select id="ed" class="form-control" id="exampleFormControlSelect1">
                                <option value="0" selected>All</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                                <option value="13">13</option>
                                <option value="14">14</option>
                                <option value="15">15</option>
                                <option value="16">16</option>
                                <option value="17">17</option>
                                <option value="18">18</option>
                                <option value="19">19</option>
                                <option value="20">20</option>
                                <option value="21">21</option>
                                <option value="22">22</option>
                                <option value="23">23</option>
                                <option value="24">24</option>
                                <option value="25">25</option>
                                <option value="26">26</option>
                                <option value="27">27</option>
                                <option value="28">28</option>
                                <option value="29">29</option>
                                <option value="30">30</option>
                                <option value="31">31</option>
                                
                            </select>
                        </div>
                        
                        <div class="form-group mr-3">
                            <label for="exampleFormControlSelect1" class="text-muted"><small>Month</small></label>
                            <select id="m" class="form-control" id="exampleFormControlSelect1">
                                <option value="0" selected>All</option>
                                <option value="1">Jan</option>
                                <option value="2">Feb</option>
                                <option value="3">Mar</option>
                                <option value="4">Apr</option>
                                <option value="5">May</option>
                                <option value="6">Jun</option>
                                <option value="7">Jul</option>
                                <option value="8">Aug</option>
                                <option value="9">Sep</option>
                                <option value="10">Oct</option>
                                <option value="11">Nov</option>
                                <option value="12">Dec</option>
                            </select>
                        </div>
                        
                        <div class="form-group mr-3">
                            <button onclick="reloadAnnualData()" class="btn btn-danger" id="btnReloadonYear">Reload</button>
                        </div>
                    </div>
                    <h5 class="card-title card-title-costum text-danger">
                        Year Summary Performance
                    </h5>
                </div>
            </div>
            <div class="card-body">
                <table id="yearSumPerformance" class="table table-striped table-bordered" style="width:100%">
                    <thead>
                        <tr>
                            <th>Day</th>
                            <th>Target Time (H)</th>
                            <th>Work Time (H)</th>
                            <th>Achievement (%)</th>
                            <th>Overtime (H)</th>
                            <th></th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
        
        <div class="card my-3 mb-5">
            <div class="card-header card-header-costum text-right">
                <h5 class="card-title card-title-costum text-danger">
                    Year Summary Performance
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div id="yearChartColumn" style="height: 400px; margin: 0 auto"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div id="yearChartPie" style="height: 400px; margin: 0 auto"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div id="yearChartArea" style="height: 400px; margin: 0 auto"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Exit -->
    <div class="modal fade" tabindex="-1" role="dialog" id="modalExit">
        <div class="modal-dialog" role="document">
            <div class="modal-content text-center">
                <div class="modal-header">
                    <h5 class="modal-title">Konfirmasi untuk keluar dari aplikasi?</h5>
                </div>
                <div class="modal-body">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="closePage" onclick="window.close()">Yes, sure</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer -->
    <div class="footer bg-dark text-right px-3 py-1">
        <span class="text-white badge-costum badge badge-pill badge-danger px-1 ct_notif" onclick="openSidePage()">10</span>
        <span class="text-white badge-costum badge badge-pill badge-success px-1 ct_inbox" onclick="openSidePage()">12</span>
        <span class="text-white">
            <small id="date">Senin, 01 JAN 2019</small>
            <small id="time" class="date-and-time">07:00</small>
        </span>
    </div>
    <div id="sidePage" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeSidePage()">&times;</a>
        <div class="container-fluid">
            <div class="container-fluid card p-2 overflow-y">
                <div class="card-header card-header-costum">
                    <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                        <h5 class="card-title card-title-costum text-danger">
                            Notifications
                        </h5>
                        <div class="ml-3">
                            <input type="text" name="search_notif" id="searchNotif" placeholder="Search" onkeyup="searchNotif()" class="form-control">
                        </div>
                    </div>
                </div>
                <div id="notif">
                    <div class="media mx-2 notif">
                        <img src="./assets/images/profile.png" class="mr-3" width="auto" height="44px" alt="profile">
                        <div class="media-body">
                            <h6 class="my-0">Helmi Zulfikar</h6>
                            <small>helmi.zulfikar20@gmail.com</small>
                        </div>
                    </div>
                    <div class="media mx-2 notif">
                        <img src="./assets/images/profile.png" class="mr-3" width="auto" height="44px" alt="profile">
                        <div class="media-body">
                            <h6 class="my-0">Helmi Zulfikar</h6>
                            <small>helmi.zulfikar20@gmail.com</small>
                        </div>
                    </div>
                    <div class="media mx-2 notif">
                        <img src="./assets/images/profile.png" class="mr-3" width="auto" height="44px" alt="profile">
                        <div class="media-body">
                            <h6 class="my-0">Helmi Zulfikar</h6>
                            <small>helmi.zulfikar20@gmail.com</small>
                        </div>
                    </div>
                    <div class="media mx-2 notif">
                        <img src="./assets/images/profile.png" class="mr-3" width="auto" height="44px" alt="profile">
                        <div class="media-body">
                            <h6 class="my-0">Helmi Zulfikar</h6>
                            <small>helmi.zulfikar20@gmail.com</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid card p-2 overflow-y mt-4">
                <div class="card-header card-header-costum">
                    <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                        <h5 class="card-title card-title-costum text-danger">
                            Inbox
                        </h5>
                        <div class="ml-3">
                            <input type="text" name="search_inbox" id="searchInbox" placeholder="Search" onkeyup="searchInbox()" class="form-control">
                        </div>
                    </div>
                </div>
                <div id="inbox">     
                </div>
            </div>
            
        </div>
        <script src="./assets/js/jquery-3.3.1.min.js"></script>
        <script src="./assets/js/popper.min.js"></script>
        <script src="./assets/js/bootstrap.min.js"></script>
        <script src="./assets/js/jquery.dataTables.min.js"></script>
        <script src="./assets/js/dataTables.bootstrap4.min.js"></script>
        <script src="./assets/js/highcharts/highcharts.js"></script>
        <script src="./assets/js/highcharts/modules/exporting.js"></script>
        <script src="./assets/js/highcharts/modules/export-data.js"></script>
        
        
        <script type="text/javascript">
            function dataLoad() {
                startTime()
                getMessage()
                getNotif()
            }
            $(document).ready(function() {
                setDailyTable()
                setYearTable()
                dailyChartColumn()
                annualChart()
            });
            function startTime() {
                var today = new Date()
                var h = today.getHours()
                var m = today.getMinutes()
                var s = today.getSeconds()
                m = checkTime(m)
                s = checkTime(s)
                var day = today.getDay()
                var date = today.toLocaleDateString()
                day = checkDay(day)
                $('#date').html(day + ', ' + date)
                $('#time').html(h + ":" + m + ":" + s)
                var t = setTimeout(startTime, 500)
            }
            function checkDay(d) {
                switch (d) {
                    case 0:
                    return "Minggu" 
                    case 1:
                    return "Senin"
                    case 2:
                    return "Selasa"
                    case 3:
                    return "Rabu"
                    case 4:
                    return "Kamis"
                    case 5:
                    return "Jumat"
                    case 6:
                    return "Sabtu"
                    default:
                    break;                       
                }
            }
            function checkMonth(m) {
                switch (m) {
                    case 1:
                    return "Jan" 
                    case 2:
                    return "Feb"
                    case 3:
                    return "Mar"
                    case 4:
                    return "Apr"
                    case 5:
                    return "May"
                    case 6:
                    return "Jun"
                    case 7:
                    return "Jul"
                    case 8:
                    return "Aug"
                    case 9:
                    return "Sep"
                    case 10:
                    return "Oct"
                    case 11:
                    return "Nov"
                    case 12:
                    return "Dec"
                    default:
                    break;                       
                }
            }
            function checkTime(i) {
                if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
                return i;
            }
            function getMessage() {
                $.get( "http://localhost:3000/data/message", function( data ) {
                    console.log(data)
                    $("#inbox").empty()
                    data.data.forEach(i => {
                        $("#inbox").append(`
                        <div class="media mx-2 notif">
                            <img src="./assets/images/profile.png" class="mr-3" width="auto" height="44px" alt="profile">
                            <div class="media-body">
                                <h6 class="my-0">${checkDay(new Date(i.date).getDay() % 7)}, ${new Date(i.date).toLocaleDateString()}</h6>
                                <small>${i.message}</small>
                            </div>
                        </div>
                        `)
                    })
                    $(".ct_inbox").html(`${data.data.length < 10 ? '0'+data.data.length : data.data.length}`)
                });          
            }
            function getNotif() {
                $.get( "http://localhost:3000/data/notification", function( data ) {
                    console.log(data)
                    $("#notif").empty()
                    data.data.forEach(i => {
                        
                        $("#notif").append(`
                        <div class="media mx-2 notif">
                            <img src="./assets/images/${i.category}.png" class="mr-3" width="auto" height="44px" alt="profile">
                            <div class="media-body">
                                <h6 class="my-0 ${i.category === 3 ? "text-danger" : i.category === 2 ? "text-warning" : "text-success"} ">${checkDay(new Date(i.date).getDay() % 7)}, ${new Date(i.date).toLocaleDateString()}</h6>
                                <small>${i.message}</small>
                            </div>
                        </div>
                        `)
                    })    
                    $(".ct_notif").html(`${data.data.length < 10 ? '0'+data.data.length : data.data.length}`)
                });   
            }            
            function setDailyTable() {
                return $('#dailyPerformance').DataTable({
                    "ajax" : "http://localhost:3000/data/performance",
                    "columns" : [{
                        data : "date"
                    }, 
                    {
                        data : "targetTime"
                    }, 
                    {
                        data : "workTime"
                    }, 
                    {
                        data : "achievement"
                    }, 
                    {
                        data : "overtime"
                    },
                    {
                        data : "date"
                    }],
                    "columnDefs": [{
                        "targets": 0,
                        "render": function ( data, type, row ) {
                            return new Date(data).getDate();
                        }
                    },
                    {
                        "targets": 5,
                        "data": null,
                        "render": function (data, type) {
                            return checkDay(new Date(data).getDay())
                        }
                    }],
                    "order": [[ 0, "desc" ]]
                });
            }
            function setYearTable() {
                return $('#yearSumPerformance').DataTable({
                    "ajax" : "http://localhost:3000/data/performancebyyear",
                    "columns" : [{
                        data : "date"
                    }, 
                    {
                        data : "targetTime"
                    }, 
                    {
                        data : "workTime"
                    }, 
                    {
                        data : "achievement"
                    }, 
                    {
                        data : "overtime"
                    },
                    {
                        data : "date"
                    }],
                    "columnDefs": [{
                        "targets": 0,
                        "render": function ( data, type, row ) {
                            return new Date(data).toLocaleDateString();
                        }
                    },
                    {
                        "targets": 5,
                        "data": null,
                        "render": function (data, type) {
                            return checkDay(new Date(data).getDay())
                        }
                    }]
                });
            }
            function openSidePage() {
                $("#sidePage").css("width","500px");
            }
            
            /* Set the width of the side navigation to 0 and the left margin of the page content to 0 */
            function closeSidePage() {
                $("#sidePage").css("width","0");
            }
            
            function dailyChartColumn() {
                $.get("http://localhost:3000/data/performance", function(data){
                    const newData = data.data.slice(-7)
                    var categories = []
                    var value = {
                        targetTime : [],
                        workTime : [],
                        achievement : [],
                        overtime : []
                    }
                    newData.forEach(v => {
                        categories.push(`${checkDay(new Date(v.date).getDay())}, ${new Date(v.date).toLocaleDateString()}`)
                        value.targetTime.push(v.targetTime)
                        value.workTime.push(v.workTime)
                        value.achievement.push(v.achievement)
                        value.overtime.push(v.overtime)
                    })
                    
                    Highcharts.chart('dailyChartColumn', {
                        chart: {
                            type: 'column'
                        },
                        title: {
                            text: 'Daily Performance'
                        },
                        xAxis: {
                            categories: categories,
                            crosshair: true
                        },
                        yAxis: {
                            min: 0,
                            title: {
                                text: 'Time (H) & Ach (%)'
                            }
                        },
                        tooltip: {
                            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                                    '<td style="padding:0"><b>{point.y:.1f}</b></td></tr>',
                                    footerFormat: '</table>',
                                    shared: true,
                                    useHTML: true
                                },
                                plotOptions: {
                                    column: {
                                        pointPadding: 0.2,
                                        borderWidth: 0
                                    }
                                },
                                series: [{
                                    name: 'Target Time',
                                    data: value.targetTime
                                },
                                {
                                    name: 'Work Time',
                                    data: value.workTime
                                },
                                {
                                    name: 'Overtime',
                                    data: value.overtime
                                },
                                {
                                    name: 'Achievement',
                                    data: value.achievement
                                }]
                            });
                        });
                    }
                    function annualChart() {
                        $.get("http://localhost:3000/data/performancebyyear/chart", function (data) {
                            const newData = data.data
                            const categories = []
                            const totals = []
                            const pieChart = []
                            newData.forEach(v => {
                                categories.push(checkMonth(v._id.month))
                                totals.push(v.achievement/v.count)
                                pieChart.push({name : checkMonth(v._id.month), y : v.achievement/v.count})
                            })
                            
                            Highcharts.chart('yearChartColumn', {
                                chart: {
                                    type: 'column'
                                },
                                title: {
                                    text: 'Column'
                                },
                                xAxis: {
                                    categories: categories,
                                    crosshair: true
                                },
                                yAxis: {
                                    min: 0,
                                    title: {
                                        text: 'Annual Summary'
                                    }
                                },
                                tooltip: {
                                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                                            '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                                            footerFormat: '</table>',
                                            shared: true,
                                            useHTML: true
                                        },
                                        plotOptions: {
                                            column: {
                                                pointPadding: 0.2,
                                                borderWidth: 0
                                            }
                                        },
                                        series: [{
                                            name: 'Average Achievement',
                                            data: totals
                                        }]
                                    });
                                    
                                    // 
                                    Highcharts.chart('yearChartArea', {
                                        chart: {
                                            type: 'areaspline'
                                        },
                                        title: {
                                            text: 'Area'
                                        },
                                        legend: {
                                            layout: 'vertical',
                                            align: 'left',
                                            verticalAlign: 'top',
                                            x: 150,
                                            y: 100,
                                            floating: true,
                                            borderWidth: 1,
                                            backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'
                                        },
                                        xAxis: {
                                            categories: categories,
                                            crosshair: true
                                        },
                                        yAxis: {
                                            title: {
                                                text: 'Summary'
                                            }
                                        },
                                        tooltip: {
                                            shared: true,
                                            valueSuffix: ''
                                        },
                                        credits: {
                                            enabled: false
                                        },
                                        plotOptions: {
                                            areaspline: {
                                                fillOpacity: 0.5
                                            }
                                        },
                                        series: [{
                                            name: 'Average Achievement',
                                            data: totals
                                        }]
                                        
                                    });
                                    
                                    // Build the chart
                                    Highcharts.chart('yearChartPie', {
                                        chart: {
                                            plotBackgroundColor: null,
                                            plotBorderWidth: null,
                                            plotShadow: false,
                                            type: 'pie'
                                        },
                                        title: {
                                            text: 'Pie'
                                        },
                                        tooltip: {
                                            pointFormat: '{series.name}: <b>{point.percentage:.1f}% or {point.y}</b>'
                                        },
                                        plotOptions: {
                                            pie: {
                                                allowPointSelect: true,
                                                cursor: 'pointer',
                                                dataLabels: {
                                                    enabled: true,
                                                    format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                                    style: {
                                                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                                    },
                                                    connectorColor: 'silver'
                                                }
                                            }
                                        },
                                        series: [{
                                            name: 'AverageAchievement',
                                            data: pieChart
                                        }]
                                    });
                                })
                            }
                            
                            function searchInbox() {
                                // Declare variables
                                var input, filter, container, content, h6, i, txtHeader, inbox, txtInbox;
                                input = document.getElementById('searchInbox');
                                filter = input.value.toUpperCase();
                                container = document.getElementById("inbox");
                                content = container.getElementsByTagName('div');
                                
                                // Loop through all list items, and hide those who don't match the search query
                                for (i = 0; i < content.length; i++) {
                                    h6 = content[i].getElementsByTagName("h6")[0];
                                    inbox = content[i].getElementsByTagName("small")[0];
                                    txtHeader = h6.textContent || h6.innerText;
                                    txtInbox = inbox.textContent || inbox.innerText;
                                    
                                    if (txtHeader.toUpperCase().indexOf(filter) > -1 || txtInbox.toUpperCase().indexOf(filter) > -1) {
                                        content[i].style.display = "";
                                    } else {
                                        content[i].style.display = "none";
                                    }
                                }
                            }
                            
                            function searchNotif() {
                                // Declare variables
                                var input, filter, container, content, h6, i, txtHeader, notif, txtNotif;
                                input = document.getElementById('searchNotif');
                                filter = input.value.toUpperCase();
                                container = document.getElementById("notif");
                                content = container.getElementsByTagName('div');
                                
                                console.log(input)
                                // Loop through all list items, and hide those who don't match the search query
                                for (i = 0; i < content.length; i++) {
                                    h6 = content[i].getElementsByTagName("h6")[0];
                                    notif = content[i].getElementsByTagName("small")[0];
                                    txtHeader = h6.textContent || h6.innerText;
                                    txtNotif = notif.textContent || notif.innerText;
                                    if (txtHeader.toUpperCase().indexOf(filter) > -1 || txtNotif.toUpperCase().indexOf(filter) > -1) {
                                        content[i].style.display = "";
                                    } else {
                                        content[i].style.display = "none";
                                    }
                                }
                            }
                            function reloadAnnualData() {
                                var startDate = $("#sd").children("option:selected").val()
                                var endDate = $("#ed").children("option:selected").val()
                                var month = $("#m").children("option:selected").val()
                                $('#yearSumPerformance').DataTable().destroy()
                                return $('#yearSumPerformance').DataTable({
                                    "ajax" : `http://localhost:3000/data/performancebyyear?sd=${startDate}&ed=${endDate}&m=${month}`,
                                    "columns" : [{
                                        data : "date"
                                    }, 
                                    {
                                        data : "targetTime"
                                    }, 
                                    {
                                        data : "workTime"
                                    }, 
                                    {
                                        data : "achievement"
                                    }, 
                                    {
                                        data : "overtime"
                                    },
                                    {
                                        data : "date"
                                    }],
                                    "columnDefs": [{
                                        "targets": 0,
                                        "render": function ( data, type, row ) {
                                            return new Date(data).toLocaleDateString();
                                        }
                                    },
                                    {
                                        "targets": 5,
                                        "data": null,
                                        "render": function (data, type) {
                                            return checkDay(new Date(data).getDay())
                                        }
                                    }]
                                });
                            }
                        </script>
                    </body>
                    </html>